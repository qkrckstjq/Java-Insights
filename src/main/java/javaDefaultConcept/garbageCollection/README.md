# GC (Garbage Collection)

---

자바에서 힙(heap) 영역에 객체들이 저장이 되는데 이 힙 영역에서 주기적으로 사용되지 않는 (참조되지 않는) 객체들을 삭제하는 기능을 말한다.

이 사용되지 않는 객체를 삭제하는 과정에서 GC를 담당하는 스레드를 제외하고 나머지 스레드들은 모두 멈추게 된다. `Stop-The-World`

GC는 Mark-And-Sweep-Compact 방식을 사용한다.

- Mark: 사용 중인 객체를 식별(마킹)
- Sweep: 마킹되지 않은 객체 제거
- Compact: 단편화된 메모리를 정리하여 연속된 공간으로 압축

이때 GC는 힙 영역중에서 두 가지 __Young, Old__ 영역으로 나누어 메모리를 관리한다.

---

## Young

새롭게 생성되는 객체들이 저장되고 관리되는 공간이다.

새롭게 생성되는 객체는 __Young__ 영역중에서 __Eden__ 의 영역에 생성된다.

이 Eden의 영역이 가득차게 되면 Minor GC를 발생시키고 생존한 객체들은 Survivor0 또는 Survivor1의 영역으로 복사되고 사용되지 않는 객체들은 삭제된다.

이후 Eden이 다시 가득 차면 반드시 Minor GC가 발생하고 Survivor의 영역이 가득 찬다면 일부 객체들이 Old 영역으로 조기 승격될 수도 있다.

이때 Survivor 영역 중 한 곳은 전부 비워지게 되며 나머지 Survivor 영역으로 이동(복사)된다.

이 이동 과정이 반복되어 생존 횟수가 일정 횟수(기본 15회)를 넘는다면 Old 영역으로 승격된다.

---

## Old

Young 영역에서 승격된 객체들이 저장되고 관리되는 공간이다.

Old 영역또한 가득 찬다면 Major GC가 발생하여 사용되지 않는 객체들이 정리된다.

Young 영역에서의 Minor GC보다 조금 더 긴 STW가 발생한다.

---

GC의 대상이 아닌 객체들도 존재하는데

static, 자바 8 이후의 default 메소드등이 예시이다.






